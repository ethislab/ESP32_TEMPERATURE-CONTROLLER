#include <arduino.h>

// LOOKUP Table for 0-500 deg C  K type Thermocouple
const float C_tck1[] = {-2.89905e-007,1.03577,2.0717,3.1077,4.14368,5.17954,6.21522,7.25063,8.2857,9.32036,10.3546,11.3882,12.4213,13.4538,14.4855,15.5166,16.5469,17.5764,18.6051,19.6329,20.6599,21.686,22.7111,23.7353,24.7585,25.7808,26.8022,27.8225,28.8419,29.8603,30.8777,31.8941,32.9095,33.924,34.9375,35.9501,36.9617,37.9724,38.9822,39.991,40.999,42.0061,43.0124,44.0178,45.0224,46.0262,47.0293,48.0316,49.0331,50.034,51.0342,52.0337,53.0327,54.031,55.0287,56.0259,57.0226,58.0188,59.0145,60.0097,61.0046,61.9991,62.9932,63.987,64.9805,65.9737,66.9666,67.9594,68.9519,69.9443,70.9366,71.9287,72.9207,73.9127,74.9047,75.8966,76.8886,77.8806,78.8726,79.8648,80.857,81.8494,82.8419,83.8346,84.8276,85.8207,86.8141,87.8077,88.8016,89.7958,90.7904,91.7852,92.7804,93.776,94.772,95.7683,96.7651,97.7623,98.7599,99.758,100.757,101.756,102.755,103.755,104.756,105.757,106.758,107.761,108.763,109.766,110.77,111.775,112.78,113.785,114.791,115.798,116.805,117.813,118.821,119.83,120.84,121.85,122.861,123.872,124.884,125.897,126.91,127.924,128.938,129.953,130.969,131.985,133.002,134.019,135.037,136.055,137.074,138.093,139.113,140.134,141.155,142.176,143.198,144.221,145.244,146.268,147.292,148.316,149.341,150.366,151.392,
152.418,153.445,154.472,155.499,156.527,157.555,158.583,159.612,160.641,161.671,162.701,163.731,164.761,165.791,166.822,167.853,168.885,169.916,170.948,171.98,173.012,174.044,175.077,176.109,177.142,178.175,179.207,180.24,181.273,182.306,183.34,184.373,185.406,186.439,187.472,188.505,189.539,190.572,191.605,192.638,193.67,194.703,195.736,196.769,197.801,198.833,199.865,200.897,201.929,202.961,203.992,205.024,206.055,207.086,208.116,209.147,210.177,211.207,212.236,213.266,214.295,215.323,216.352,217.38,218.408,219.435,220.462,221.489,222.516,223.542,224.568,225.593,226.618,227.643,228.667,229.691,230.714,231.737,232.76,233.782,234.804,235.826,236.847,237.868,238.888,239.908,240.927,241.946,242.964,243.983,245,246.017,247.034,248.051,249.066,250.082,251.097,252.111,253.126,254.139,255.152,256.165,257.178,258.189,259.201,260.212,261.222,262.233,263.242,264.252,265.26,266.269,267.277,268.284,269.291,270.298,271.304,272.31,273.316,274.321,275.325,276.33,277.333,278.337,279.34,280.342,281.345,282.347,283.348,284.349,285.35,286.35,287.35,288.35,289.349,290.348,291.347,292.345,293.343,294.341,295.338,296.335,297.332,298.328,299.324,300.32,301.315,302.31,303.305,304.299,305.294,306.288,307.281,308.275,309.268,310.261,
311.253,312.246,313.238,314.23,315.222,316.213,317.204,318.195,319.186,320.176,321.167,322.157,323.147,324.136,325.126,326.115,327.104,328.093,329.082,330.07,331.059,332.047,333.035,334.022,335.01,335.998,336.985,337.972,338.959,339.946,340.932,341.919,342.905,343.891,344.877,345.863,346.849,347.835,348.82,349.805,350.79,351.775,352.76,353.745,354.73,355.714,356.698,357.683,358.667,359.651,360.634,361.618,362.601,363.585,364.568,365.551,366.534,367.517,368.499,369.482,370.464,371.447,372.429,373.411,374.392,375.374,376.356,377.337,378.318,379.299,380.28,381.261,382.242,383.222,384.203,385.183,386.163,387.143,388.123,389.102,390.082,391.061,392.04,393.019,393.998,394.977,395.955,396.934,397.912,398.89,399.868,400.845,401.823,402.8,403.777,404.755,405.731,406.708,407.685,408.661,409.637,410.613,411.589,412.565,413.541,414.516,415.492,416.467,417.442,418.417,419.391,420.366,421.34,422.315,423.289,424.263,425.236,426.21,427.184,428.157,429.13,430.104,431.077,432.05,433.022,433.995,434.968,435.94,436.912,437.885,438.857,439.829,440.801,441.773,442.745,443.716,444.688,445.66,446.631,447.602,448.574,449.545,450.516,451.488,452.459,453.43,454.401,455.372,456.343,457.314,458.285,459.256,460.227,461.198,462.169,463.139,
464.11,465.081,466.052,467.023,467.993,468.964,469.935,470.906,471.876,472.847,473.818,474.788,475.759,476.73,477.7,478.671,479.641,480.611,481.582,482.552,483.522,484.492,485.462,486.431,487.401,488.37,489.339,490.308,491.277,492.245,493.214,494.181,495.149,496.116,497.083,498.049,499.015,499.98};

// LOOKUP Table for 500- 1372 deg C  K type Thermocouple
const float C_tck2[] = {499.947,500.872,501.796,502.72,503.644,504.568,505.491,506.415,507.339,508.262,509.185,510.109,511.032,511.955,512.878,513.801,514.723,515.646,516.569,517.491,518.414,519.336,520.258,521.181,522.103,523.025,523.947,524.869,525.791,526.713,527.634,528.556,529.478,530.399,531.321,532.243,533.164,534.086,535.007,535.929,536.85,537.771,538.693,539.614,540.535,541.456,542.378,543.299,544.22,545.141,546.062,546.983,547.904,548.826,549.747,550.668,551.589,552.51,553.431,554.352,555.273,556.194,557.116,558.037,558.958,559.879,560.8,561.721,562.642,563.564,564.485,565.406,566.327,567.249,568.17,569.091,570.013,570.934,571.856,572.777,573.699,574.62,575.542,576.464,577.385,578.307,579.229,580.151,581.073,581.995,582.917,583.839,584.761,585.683,586.605,587.527,588.45,589.372,590.295,591.217,592.14,593.062,593.985,594.908,595.831,596.754,597.677,598.6,599.523,600.446,601.37,602.293,603.217,604.14,605.064,605.988,606.912,607.835,608.759,609.684,610.608,611.532,612.456,613.381,614.306,615.23,616.155,617.08,618.005,618.93,619.855,620.78,621.706,622.631,623.557,624.483,625.408,626.334,627.26,628.187,629.113,630.039,630.966,631.892,632.819,633.746,634.673,635.6,636.527,637.454,638.382,639.31,640.237,
641.165,642.093,643.021,643.949,644.878,645.806,646.735,647.664,648.592,649.521,650.451,651.38,652.309,653.239,654.169,655.098,656.028,656.958,657.889,658.819,659.75,660.68,661.611,662.542,663.473,664.404,665.336,666.267,667.199,668.131,669.063,669.995,670.928,671.86,672.793,673.725,674.658,675.591,676.525,677.458,678.392,679.325,680.259,681.193,682.128,683.062,683.996,684.931,685.866,686.801,687.736,688.671,689.607,690.543,691.478,692.414,693.351,694.287,695.223,696.16,697.097,698.034,698.971,699.909,700.846,701.784,702.722,703.66,704.598,705.536,706.475,707.414,708.353,709.292,710.231,711.17,712.11,713.05,713.99,714.93,715.87,716.811,717.752,718.693,719.634,720.575,721.516,722.458,723.4,724.342,725.284,726.226,727.169,728.112,729.055,729.998,730.941,731.885,732.828,733.772,734.716,735.66,736.605,737.55,738.494,739.439,740.385,741.33,742.276,743.221,744.167,745.114,746.06,747.006,747.953,748.9,749.847,750.795,751.742,752.69,753.638,754.586,755.534,756.483,757.432,758.38,759.33,760.279,761.228,762.178,763.128,764.078,765.029,765.979,766.93,767.881,768.832,769.783,770.735,771.686,772.638,773.591,774.543,775.495,776.448,777.401,778.354,779.308,780.261,781.215,782.169,783.123,784.078,785.032,785.987,786.942,
787.897,788.853,789.809,790.764,791.721,792.677,793.633,794.59,795.547,796.504,797.461,798.419,799.377,800.335,801.293,802.251,803.21,804.169,805.128,806.087,807.046,808.006,808.966,809.926,810.886,811.847,812.808,813.769,814.73,815.691,816.653,817.615,818.577,819.539,820.502,821.464,822.427,823.39,824.354,825.317,826.281,827.245,828.209,829.174,830.138,831.103,832.068,833.034,833.999,834.965,835.931,836.897,837.864,838.83,839.797,840.764,841.732,842.699,843.667,844.635,845.603,846.572,847.54,848.509,849.478,850.448,851.417,852.387,853.357,854.327,855.298,856.269,857.24,858.211,859.182,860.154,861.125,862.098,863.07,864.042,865.015,865.988,866.961,867.935,868.908,869.882,870.856,871.831,872.805,873.78,874.755,875.731,876.706,877.682,878.658,879.634,880.61,881.587,882.564,883.541,884.519,885.496,886.474,887.452,888.431,889.409,890.388,891.367,892.346,893.326,894.305,895.285,896.266,897.246,898.227,899.208,900.189,901.17,902.152,903.134,904.116,905.098,906.081,907.064,908.047,909.03,910.014,910.998,911.982,912.966,913.951,914.935,915.92,916.906,917.891,918.877,919.863,920.849,921.836,922.823,923.81,924.797,925.784,926.772,927.76,928.748,929.737,930.726,931.715,932.704,933.693,934.683,935.673,936.663,937.654,
938.645,939.636,940.627,941.618,942.61,943.602,944.594,945.587,946.58,947.573,948.566,949.56,950.553,951.547,952.542,953.536,954.531,955.526,956.522,957.517,958.513,959.509,960.506,961.502,962.499,963.497,964.494,965.492,966.49,967.488,968.486,969.485,970.484,971.483,972.483,973.483,974.483,975.483,976.484,977.485,978.486,979.488,980.489,981.491,982.494,983.496,984.499,985.502,986.505,987.509,988.513,989.517,990.521,991.526,992.531,993.536,994.542,995.548,996.554,997.56,998.567,999.574,1000.58,1001.59,1002.6,1003.6,1004.61,1005.62,1006.63,1007.64,1008.65,1009.66,1010.67,1011.68,1012.69,1013.7,1014.71,1015.72,1016.74,1017.75,1018.76,1019.77,1020.79,1021.8,1022.81,1023.83,1024.84,1025.85,1026.87,1027.88,1028.9,1029.92,1030.93,1031.95,1032.96,1033.98,1035,1036.02,1037.03,1038.05,1039.07,1040.09,1041.11,1042.13,1043.15,1044.17,1045.19,1046.21,1047.23,1048.25,1049.27,1050.29,1051.31,1052.34,1053.36,1054.38,1055.41,1056.43,1057.45,1058.48,1059.5,1060.53,1061.55,1062.58,1063.6,1064.63,1065.66,1066.68,1067.71,1068.74,1069.77,1070.79,1071.82,1072.85,1073.88,1074.91,1075.94,1076.97,1078,1079.03,1080.06,1081.09,1082.12,1083.16,1084.19,1085.22,1086.25,1087.29,1088.32,1089.36,1090.39,1091.43,1092.46,1093.5,1094.53,1095.57,
1096.6,1097.64,1098.68,1099.72,1100.75,1101.79,1102.83,1103.87,1104.91,1105.95,1106.99,1108.03,1109.07,1110.11,1111.15,1112.2,1113.24,1114.28,1115.32,1116.37,1117.41,1118.46,1119.5,1120.54,1121.59,1122.64,1123.68,1124.73,1125.77,1126.82,1127.87,1128.92,1129.96,1131.01,1132.06,1133.11,1134.16,1135.21,1136.26,1137.31,1138.36,1139.42,1140.47,1141.52,1142.57,1143.63,1144.68,1145.73,1146.79,1147.84,1148.9,1149.95,1151.01,1152.07,1153.12,1154.18,1155.24,1156.3,1157.35,1158.41,1159.47,1160.53,1161.59,1162.65,1163.71,1164.78,1165.84,1166.9,1167.96,1169.03,1170.09,1171.15,1172.22,1173.28,1174.35,1175.41,1176.48,1177.54,1178.61,1179.68,1180.75,1181.81,1182.88,1183.95,1185.02,1186.09,1187.16,1188.23,1189.3,1190.38,1191.45,1192.52,1193.59,1194.67,1195.74,1196.81,1197.89,1198.96,1200.04,1201.12,1202.19,1203.27,1204.35,1205.43,1206.5,1207.58,1208.66,1209.74,1210.82,1211.9,1212.98,1214.07,1215.15,1216.23,1217.31,1218.4,1219.48,1220.57,1221.65,1222.74,1223.82,1224.91,1226,1227.09,1228.17,1229.26,1230.35,1231.44,1232.53,1233.62,1234.71,1235.8,1236.9,1237.99,1239.08,1240.17,1241.27,1242.36,1243.46,1244.55,1245.65,1246.75,1247.84,1248.94,1250.04,1251.14,1252.24,1253.34,1254.44,1255.54,1256.64,1257.74,1258.84,1259.95,1261.05,1262.15,
1263.26,1264.36,1265.47,1266.58,1267.68,1268.79,1269.9,1271.01,1272.11,1273.22,1274.33,1275.44,1276.56,1277.67,1278.78,1279.89,1281.01,1282.12,1283.23,1284.35,1285.46,1286.58,1287.7,1288.81,1289.93,1291.05,1292.17,1293.29,1294.41,1295.53,1296.65,1297.77,1298.9,1300.02,1301.14,1302.27,1303.39,1304.52,1305.64,1306.77,1307.9,1309.03,1310.15,1311.28,1312.41,1313.54,1314.68,1315.81,1316.94,1318.07,1319.21,1320.34,1321.47,1322.61,1323.75,1324.88,1326.02,1327.16,1328.3,1329.43,1330.57,1331.71,1332.86,1334,1335.14,1336.28,1337.43,1338.57,1339.72,1340.86,1342.01,1343.15,1344.3,1345.45,1346.6,1347.75,1348.9,1350.05,1351.2,1352.35,1353.51,1354.66,1355.81,1356.97,1358.12,1359.28,1360.44,1361.59,1362.75,1363.91,1365.07,1366.23,1367.39,1368.55,1369.72,1370.88,499.947};



/* for range of 0 to 500 deg c of TC*/ 
//#define TMIN1 (0)       // = minimum temperature in degC
//#define TMAX1 (500)     // = maximum temperature in degC
#define VMIN1 (0)       // = input voltage in mvolts  at 0 degC
#define VMAX1 (20.644)  // = input voltage in mvolts  at 500 degC
#define NSEG1 500       // = number of sections in table
#define VSEG1 0.041288  // = (VMAX-VMIN)/NSEG = voltage VSEG in mvolts of each segment


/****************************************************************/
/**voltage to temperature function of K- Type Thermocouple for the range of 0-500 deg C**/
float T_tck1(float v) {
  int i = (v-VMIN1)/VSEG1;       // determine which coefficients to use
  if (i<0)               // if input is under-range..
    i=0;                 // ..then use lowest coefficients
  else if (i>NSEG1-1)     // if input is over-range..
    i=NSEG1-1;            // ..then use highest coefficients
  float t = pgm_read_float(C_tck1+i)+(v-(VMIN1+VSEG1*i))*(pgm_read_float(C_tck1+i+1)-pgm_read_float(C_tck1+i))/VSEG1;
  return (t);
}


#define VMIN2 (20.644)       // = input voltage in mvolts  at 0 degC
#define VMAX2 (54.886)  // = input voltage in mvolts  at 500 degC
#define NSEG2 872       // = number of sections in table
#define VSEG2 0.039268348  // = (VMAX-VMIN)/NSEG = voltage VSEG in mvolts of each segment


/**voltage to temperature function of K- Type Thermocouple for the range of 500*1372 deg C**/
float T_tck2(float v) {
  int i = (v-VMIN2)/VSEG2;       // determine which coefficients to use
  if (i<0)               // if input is under-range..
    i=0;                 // ..then use lowest coefficients
  else if (i>NSEG2-1)     // if input is over-range..
    i=NSEG2-1;            // ..then use highest coefficients
  float t = pgm_read_float(C_tck2+i)+(v-(VMIN2+VSEG2*i))*(pgm_read_float(C_tck2+i+1)-pgm_read_float(C_tck2+i))/VSEG2;
  return (t);
}
